<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" class="logo" width="120"/>

# ClaudeCodeの新機能Sub Agentsで短い文章の要件でも高い品質のコードを出力できるエージェントを作れないだろうか？

「Sub Agents」を活用すれば、**短い要件でも高品質なコードを安定して出力する特化型エージェント**を構築できます。

## Sub Agentsの特徴と強み

- 各Sub Agentは**専門の役割・コンテキスト・専用プロンプト**を持ち、メイン会話から独立して動作
- 小さな指示（例：「フォーム画面作成」「入力チェック追加」）でも、その目的に最適化された出力を返せる


## 高品質出力に特化したサブエージェント作成のベストプラクティス

### 1. **Sub Agent作成手順（概要）**

1. `/agents` コマンドで新規Agent作成
2. **目的・得意分野・出力品質基準**を明確にシステムプロンプトに記述
    - 例：「React/TypeScriptコンポーネントを短い要件から要求仕様を補完しつつ、テスト可能な形で出力」
    - 制約やコードスタイル（ESLint, Prettier, テスト必須等）も併記
3. 必要に応じて**参照ツールやライブラリ、コーディング規約**も指定
4. 内容を.mdファイル（例：`.claude/agents/high-quality-react-writer.md`）で保存

### 2. **システムプロンプト設計のコツ**

- **短い要件でも省略せず明確化するよう促す**
例：「要件が不足していれば、実装成否に影響する仕様を自動で補足」
- **出力サンプルやテストケースを必ず付与」等の方針を盛り込む**
- **「MUST BE USED」や「PROACTIVELY」などの強調句をdescription項目に追加**
→ 自動で該当タスクを優先的に担当させ、品質担保を図る[^1][^2][^3]


### 3. **利用・呼び出し方法**

- メイン指示で明示的にエージェント名を指定
例：「`high-quality-react-writer`サブエージェントを使ってこの要件に沿うフォーム画面を作って」
- 複数Sub Agent型で**バリデーション/リファクタ/レビュー**を分担させることで工程ごとの品質も自動化[^4][^5]


## 実践例：短い要件 × 高品質コード

例えば**「ユーザー登録画面をReactで」**という短い依頼でも、
サブエージェントのシステムプロンプトで

- 入力バリデーション・型安全性
- UI/UX配慮
- 単体テスト
- ESLint/Prettier準拠
など詳細仕様を自律的に補い、**1回でほぼ完成レベルのコードを自動出力**させることができます。


### まとめ

- Sub Agentsは**コンテキスト分離・専門化・高品質出力保証**に優れる
- **短い要件でも高品質コード化が可能なエージェント**は、「システムプロンプトの工夫」と「タスク分担の明確化」で簡単に作れる
- 専門エージェントにプロジェクト標準を徹底させることで、AI活用の生産性・品質向上が実現します[^1][^2][^3][^4][^5][^6][^7][^8][^9]

---



短い要件文でも高品質なコード出力に導くカスタムシステムプロンプトは、「前提条件の自動補完」「厳密な役割付与」「制約明示」「出力形式指定」を盛り込むことで実現できます。



## 高品質コードを引き出すカスタムシステムプロンプト設計の原則

- **役割の明示**：「あなたは◯◯分野のプロエンジニア」
- **制約条件・クオリティ基準の明示**：「高い可読性・堅牢性・プロジェクト標準のコード」「テストコード必須」など
- **要件補完指示**：「要件が不明瞭な場合は、品質確保に必要な仕様を自律的に補足して判断」
- **出力形式の指定**：「コード（+コメントあり）、テストファイル、説明の3点セットで」
- **省略なきバリデーション指示**：「前提条件が不足する場合は“必要な追加情報”をまず箇条書きで提示し、その上で最善の仮定を補ってコード作成」

## 具体例：短文入力にも対応するシステムプロンプト

```txt
---
name: high-quality-web-dev
description: "[MUST BE USED] Reactプロジェクトで機能やコンポーネントの追加・修正に関する指示が出された場合のみ起動。この用途以外では呼び出さないこと。"
---

あなたはハイレベルな実績を持つプロのReactアプリエンジニアです。

ユーザーから与えられた要件が短文や曖昧でも、Web開発ベストプラクティス＆型安全＆テスト重視で高品質なReact/TypeScriptコードを生成するエージェント。要件があいまいなら必要な仕様を自動で補足して仮定し、最良案で進める。成果物はESLint/Prettier・Jestに準拠し、常に高品質のコードを目指す。

# 出力ルール

1. 指示が短い場合も「自動で考慮すべき仕様」や前提条件を合理的に推定し補足してください
2. まず不足情報を箇条書きで整理し、不明点はベストプラクティスに基づき仮定してください
3. React/TypeScriptで堅牢・保守的・テスト容易なコードのみ出力
4. コーディング規約・命名規則・型安全性も厳格に守ること
5. 曖昧すぎ・不足分が多い場合はユーザーへどの要件が足りないかを具体的な文章でリスト出力し、停止する
```

------

## 参考：ベストプラクティス

- 深津式プロンプト（命令・制約・入力文・出力文…型の活用）[5](https://ai-island-media.com/2023/08/28/chatgpt-prompt-20/)
- 「前提条件が不明ならまず仮定&質問リストを出す」方針[RQプロンプト][5](https://ai-island-media.com/2023/08/28/chatgpt-prompt-20/)
- Markdown構造や見出し・箇条書きでの明確化[4](https://ryusei-komada.com/chatgpt-prompt-writing-beginners/)
- 役割・目標・制約・出力例の4点セットで記述[2](https://ai-buddies.jp/column/chatgpt-prompt/)[5](https://ai-island-media.com/2023/08/28/chatgpt-prompt-20/)[6](https://note.com/brightiers/n/n7cf51c6aaf17)

このように設計すれば　**「ユーザーフォームをReactで」** のような短文にも、自律的補完と高品質な実装＋解説まで対応できます。
